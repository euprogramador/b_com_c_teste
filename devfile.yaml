# cspell: disable=devspaces
schemaVersion: 2.2.2
metadata:
  name: ansible-dev-environment

attributes:
  controller.devfile.io/scc: container-build
  controller.devfile.io/pod-overrides: |
  {
    "spec": {
      "volumes": [
        { "name": "dev-fuse", "hostPath": { "path": "/dev/fuse", "type": "CharDevice" } }
      ]
    }
  }
components:
  - name: tooling-container
    attributes:
      container-overrides:
        securityContext:
          runAsNonRoot: false
    container:
      image: quay.io/mycloudlab/ansible-devspaces:latest
      memoryRequest: 256M
      memoryLimit: 6Gi
      cpuRequest: 250m
      cpuLimit: 2000m
      args: ['tail', '-f', '/dev/null']
      mountSources: true
      volumeMounts:
        - name: dev-fuse
          path: /dev/fuse
      env:
        - name: 'ANSIBLE_COLLECTIONS_PATH'
          value: '~/.ansible/collections:/usr/share/ansible/collections:/projects/automation/collections'
        - name: 'KUBEDOCK_ENABLED'
          value: "true"


